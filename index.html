<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlantic Security Email Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            padding: 20px;
            color: #333;
            position: relative;
            overflow-x: hidden;
            background: linear-gradient(180deg, #ffffff 0%, #1e3a8a 100%);
            background-attachment: fixed;
        }
        
        .scroll-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #ffffff 0%, #1e3a8a 100%);
            z-index: -1;
            transition: background 0.3s ease;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3a8a 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 8px;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 18px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .instructions {
            background: rgba(248, 249, 250, 0.8);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-bottom: 1px solid rgba(233, 236, 239, 0.5);
        }
        
        .instructions h3 {
            color: #2c5aa0;
            font-size: 22px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            font-weight: 600;
        }
        
        .instructions h3::before {
            content: '';
            margin-right: 12px;
            width: 26px;
            height: 26px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232c5aa0'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm2 18H6V4h7v5h5v11z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 20px;
        }
        
        .step {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #2c5aa0, #4a90e2);
        }
        
        .step:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }
        
        .step-number {
            background: linear-gradient(135deg, #2c5aa0, #4a90e2);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
        }
        
        .step h4 {
            color: #2c5aa0;
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .step p {
            color: #555;
            font-size: 15px;
            line-height: 1.6;
            margin: 0;
        }
        
        .form-container {
            padding: 40px 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        label {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        label.required::after {
            content: ' *';
            color: #dc3545;
            font-weight: bold;
        }
        
        input, select {
            padding: 16px 18px;
            border: 2px solid rgba(225, 229, 233, 0.8);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 4px rgba(44, 90, 160, 0.1);
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 1);
        }
        
        .currency-input {
            position: relative;
        }
        
        .currency-input::before {
            content: '$';
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-weight: 600;
            z-index: 1;
        }
        
        .currency-input input {
            padding-left: 40px;
        }
        
        .preview-section {
            background: rgba(248, 249, 250, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(222, 226, 230, 0.5);
        }
        
        .preview-title {
            font-size: 22px;
            font-weight: 600;
            color: #2c5aa0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .preview-title::before {
            content: '';
            margin-right: 12px;
            width: 26px;
            height: 26px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232c5aa0'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .preview-content {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(222, 226, 230, 0.5);
            border-radius: 12px;
            padding: 25px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            color: #333;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            min-width: 200px;
            justify-content: center;
            backdrop-filter: blur(10px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3a8a 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(44, 90, 160, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(44, 90, 160, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(108, 117, 125, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.4);
        }
        
        .btn::before {
            content: '';
            width: 20px;
            height: 20px;
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .btn-secondary::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z'/%3E%3C/svg%3E");
        }
        
        .btn-primary::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z'/%3E%3C/svg%3E");
        }
        
        .success-message {
            background: linear-gradient(135deg, rgba(212, 237, 218, 0.9) 0%, rgba(195, 230, 203, 0.9) 100%);
            backdrop-filter: blur(15px);
            color: #155724;
            padding: 25px;
            border-radius: 16px;
            margin-top: 25px;
            display: none;
            border: 1px solid rgba(40, 167, 69, 0.3);
            box-shadow: 0 8px 32px rgba(40, 167, 69, 0.2);
        }
        
        .success-message.show {
            display: block;
            animation: slideIn 0.4s ease-out;
        }
        
        .success-message::before {
            content: '';
            display: inline-block;
            width: 28px;
            height: 28px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23155724'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
            margin-right: 15px;
            vertical-align: top;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #2c5aa0;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: '';
            margin-right: 15px;
            width: 28px;
            height: 28px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232c5aa0'%3E%3Cpath d='M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .empty-preview {
            text-align: center;
            color: #999;
            padding: 50px 20px;
        }
        
        .empty-preview::before {
            content: '';
            display: block;
            width: 48px;
            height: 48px;
            margin: 0 auto 20px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23999'%3E%3Cpath d='M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .container {
                margin: 10px;
            }
            
            .steps {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .form-container {
                padding: 30px 20px;
            }
            
            .instructions {
                padding: 25px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="scroll-background"></div>
    
    <div class="container">
        <div class="header">
            <h1>ATLANTIC SECURITY</h1>
            <p> Email Discount Generator</p>
        </div>
        
        <div class="instructions">
            <h3>How to Use</h3>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h4>Fill Out the Form</h4>
                    <p>Enter the customer's information in the fields below. All fields marked with * are required for the email generation.</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h4>Review the Preview</h4>
                    <p>Check the email preview to ensure all information is correct and the formatting looks professional.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h4>Copy the Email</h4>
                    <p>Click "Copy HTML" to copy the professionally formatted email template to your clipboard.</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h4>Paste in Outlook</h4>
                    <p>Open Outlook, create a new email, switch to HTML view, and paste the copied template code.</p>
                </div>
            </div>
        </div>
        
        <div class="form-container">
            <div class="form-section">
                <div class="section-title">Customer Information</div>
                <form id="emailForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="customerName" class="required">Customer Name</label>
                            <input type="text" id="customerName" name="customerName" required placeholder="John Smith">
                        </div>
                        
                        <div class="form-group">
                            <label for="customerId" class="required">Customer ID</label>
                            <input type="text" id="customerId" name="customerId" required placeholder="12345">
                        </div>
                        
                        <div class="form-group">
                            <label for="quoteId" class="required">Quote ID</label>
                            <input type="text" id="quoteId" name="quoteId" required placeholder="QT-2024-001">
                        </div>
                        
                        <div class="form-group">
                            <label for="originalPrice" class="required">Original Quote Price</label>
                            <div class="currency-input">
                                <input type="number" id="originalPrice" name="originalPrice" required placeholder="1000.00" step="0.01" min="0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="discountPercent" class="required">Discount Percentage</label>
                            <select id="discountPercent" name="discountPercent" required>
                                <option value="">Select discount</option>
                                <option value="10">10%</option>
                                <option value="15">15%</option>
                                <option value="20">20%</option>
                                <option value="25">25%</option>
                                <option value="30">30%</option>
                            </select>
                        </div>
                        

                    </div>
                </form>
            </div>
            
            <div class="preview-section">
                <div class="preview-title">Email Preview</div>
                <div class="preview-content" id="emailPreview">
                    <div class="empty-preview">
                        <div style="font-size: 18px; margin-bottom: 15px; font-weight: 500;">Fill out the form above to see your personalized email preview</div>
                        <div style="font-size: 14px; opacity: 0.8;">The preview will update automatically as you type</div>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button type="button" class="btn btn-secondary" onclick="copyToClipboard()">
                    Copy HTML
                </button>
                <button type="button" class="btn btn-primary" onclick="sendEmail()">
                    Send in Outlook
                </button>
                <button type="button" class="btn btn-success" onclick="downloadHTML()">
                    Download HTML File
                </button>
            </div>
            
            <div class="success-message" id="successMessage">
                <div style="display: flex; align-items: flex-start; gap: 15px;">
                    <div>
                        <strong style="font-size: 18px;">Success! Email HTML copied to clipboard!</strong>
                        <br><br>
                        <strong style="color: #2c5aa0;">Next Steps:</strong>
                        <ol style="margin: 15px 0 0 25px; line-height: 1.8; font-size: 15px;">
                            <li>Open Microsoft Outlook</li>
                            <li>Click "New Email" to create a new message</li>
                            <li>Click the "Format Text" tab in the ribbon</li>
                            <li>Click the "HTML" button to switch to HTML view</li>
                            <li>Paste the copied code (Ctrl+V or Cmd+V)</li>
                            <li>Add the recipient's email address and send!</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-generate customer ID if not provided
        function generateCustomerId() {
            return Math.floor(Math.random() * 90000) + 10000;
        }

        // Update background based on scroll position
        function updateBackground() {
            const scrollPercent = window.scrollY / (document.body.scrollHeight - window.innerHeight);
            const scrollBackground = document.querySelector('.scroll-background');
            
            // Interpolate between white and navy blue
            const startColor = [255, 255, 255]; // White
            const endColor = [30, 58, 138]; // Navy blue
            
            const currentColor = startColor.map((start, i) => {
                return Math.round(start + (endColor[i] - start) * scrollPercent);
            });
            
            scrollBackground.style.background = `linear-gradient(180deg, rgb(${currentColor[0]}, ${currentColor[1]}, ${currentColor[2]}) 0%, rgb(${Math.round(currentColor[0] * 0.8)}, ${Math.round(currentColor[1] * 0.8)}, ${Math.round(currentColor[2] * 0.8)}) 100%)`;
        }

        // Update preview in real-time
        function updatePreview() {
            const customerName = document.getElementById('customerName').value || 'Customer Name';
            const customerId = document.getElementById('customerId').value || generateCustomerId();
            const quoteId = document.getElementById('quoteId').value || 'QT-XXXX-XXX';
            const originalPrice = document.getElementById('originalPrice').value || '0.00';
            const discountPercent = document.getElementById('discountPercent').value || '0';
            
            const finalPrice = (originalPrice * (1 - discountPercent/100)).toFixed(2);
            
            const preview = `
                <div style="border: 1px solid #e0e0e0; border-radius: 12px; padding: 25px; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="margin-bottom: 20px;">
                        <strong style="color: #2c5aa0; font-size: 16px;">Customer ID:</strong> ${customerId}
                    </div>
                    <div style="margin-bottom: 20px;">
                        <strong style="color: #2c5aa0; font-size: 16px;">Subject:</strong> Special Offer for ${customerName} - Save ${discountPercent}% on Quote ${quoteId}
                    </div>
                    <hr style="border: none; border-top: 1px solid #eee; margin: 20px 0;">
                    <div style="font-size: 13px; color: #666; line-height: 1.6;">
                        <strong>Customer:</strong> ${customerName}<br>
                        <strong>Customer ID:</strong> ${customerId}<br>
                        <strong>Quote ID:</strong> ${quoteId}<br>
                        <strong>Original Price:</strong> $${parseFloat(originalPrice).toFixed(2)}<br>
                        <strong>Discount:</strong> ${discountPercent}%<br>
                        <strong>Final Price:</strong> $${finalPrice}
                    </div>
                </div>
            `;
            
            document.getElementById('emailPreview').innerHTML = preview;
        }

        // Generate the complete email HTML
        function generateEmailHTML() {
            const customerName = document.getElementById('customerName').value;
            const customerId = document.getElementById('customerId').value || generateCustomerId();
            const quoteId = document.getElementById('quoteId').value;
            const originalPrice = parseFloat(document.getElementById('originalPrice').value).toFixed(2);
            const discountPercent = document.getElementById('discountPercent').value;
            
            const encodedParams = new URLSearchParams({
                customer_id: customerId,
                quote_id: quoteId,
                original_price: originalPrice,
                discount: discountPercent,
                name: customerName
            }).toString();
            
            const dynamicURL = `https://atlantic-email.vercel.app/?${encodedParams}`;
            
            return `<!DOCTYPE html>
<html lang="en">
  <body style="margin:0; padding:0; font-family:Arial, sans-serif; background:#f5f7fa; color:#333;">
    <table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="max-width: 600px; margin:auto; background:#ffffff; border:1px solid #e0e0e0;">
      <!-- Header -->
      <tr>
        <td align="center" style="background-color: #2c5aa0; padding: 35px 20px;">
          <h1 style="color:#ffffff; font-size:26px; margin:0; font-weight:bold; letter-spacing:1px;">ATLANTIC SECURITY</h1>
          <table width="120" cellpadding="0" cellspacing="0" border="0" align="center" style="margin:15px auto;">
            <tr><td style="height:3px; background:linear-gradient(90deg, transparent 0%, #ffffff 50%, transparent 100%); font-size:1px; line-height:1px;">&nbsp;</td></tr>
          </table>
          <p style="margin:0; font-size:14px; color:#ffffff; font-weight:normal;">Professional Security &amp; Automation Services</p>
        </td>
      </tr>
      
      <!-- Main Offer -->
      <tr>
        <td style="padding: 35px 25px; text-align:center; background:#ffffff;">
          <h2 style="color:#2c5aa0; font-size:22px; font-weight:bold; margin:0 0 20px 0;">You Have a Special Offer!</h2>
          
          <p style="color:#666; font-size:16px; line-height:1.5; margin:0 0 20px 0;">
            Hello ${customerName},
          </p>
          
          <!-- Info Box -->
          <table width="100%" cellpadding="20" cellspacing="0" border="0" style="background:#f8f9ff; border:1px solid #e0e6ff; margin:20px 0;">
            <tr>
              <td style="border-left:4px solid #2c5aa0;">
                <p style="color:#555; font-size:16px; line-height:1.5; margin:0;">
                  <strong style="color:#2c5aa0;">Great news!</strong> We've prepared an exclusive discount on your original system quote. This special offer has been created specifically for you.
                </p>
              </td>
            </tr>
          </table>
          
          <!-- Discount Badge -->
          <table cellpadding="0" cellspacing="0" border="0" align="center" style="margin:25px auto;">
            <tr>
              <td style="background:#ffffff; border:3px solid #2c5aa0; padding:15px 30px; text-align:center;">
                <h3 style="font-size:20px; font-weight:bold; margin:0; letter-spacing:1px; color:#2c5aa0;">SAVE UP TO ${discountPercent}% OFF</h3>
              </td>
            </tr>
          </table>
          
          <!-- Call to Action -->
          <p style="margin: 25px 0 20px; font-weight:bold; color:#555; font-size:16px;">Click the button below to view your exclusive offer:</p>
          
          <table cellpadding="0" cellspacing="0" border="0" align="center">
            <tr>
              <td style="background:#2c5aa0; padding:0; border-radius:4px;">
                <a href="${dynamicURL}" 
                   style="display:block; padding:15px 30px; background:#2c5aa0; color:#ffffff; text-decoration:none; font-weight:bold; font-size:16px; border-radius:4px;">
                  VIEW MY SPECIAL OFFER
                </a>
              </td>
            </tr>
          </table>
          
          <p style="margin:15px 0 0; font-size:12px; color:#999; font-style:italic;">This exclusive offer expires soon!</p>
        </td>
      </tr>
      
      <!-- Quote Information -->
      <tr>
        <td style="padding: 25px; background: #ffffff;">
          <table width="100%" cellpadding="20" cellspacing="0" border="0" style="background:#f8f9fa; border:1px solid #e0e0e0;">
            <tr>
              <td>
                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                  <tr>
                    <td style="border-left:4px solid #2c5aa0; padding-left:15px;">
                      <h4 style="color:#2c5aa0; font-size:18px; font-weight:bold; margin:0 0 15px 0;">Your Quote Information</h4>
                    </td>
                  </tr>
                </table>
                
                <table width="100%" cellpadding="6" cellspacing="0" border="0" style="font-size:15px;">
                  <tr>
                    <td style="color:#666; padding:6px 0; border-bottom:1px solid #e0e0e0;">Quote ID:</td>
                    <td align="right" style="color:#333; font-weight:bold; padding:6px 0; border-bottom:1px solid #e0e0e0;">${quoteId}</td>
                  </tr>
                  <tr>
                    <td style="color:#666; padding:6px 0; border-bottom:1px solid #e0e0e0;">Original Quote:</td>
                    <td align="right" style="color:#333; font-weight:bold; padding:6px 0; border-bottom:1px solid #e0e0e0;">$${originalPrice}</td>
                  </tr>
                  <tr>
                    <td style="color:#666; padding:6px 0;">Your Special Price:</td>
                    <td align="right" style="color:#e74c3c; font-weight:bold; padding:6px 0;">Click above to reveal!</td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      
      <!-- Footer -->
      <tr>
        <td style="background-color: #2c3e50; color: white; text-align:center; padding: 25px;">
          <p style="margin:0 0 15px; font-size:16px; font-weight:bold;">Questions? We're Here to Help!</p>
          
          <table cellpadding="0" cellspacing="0" border="0" align="center" style="margin:10px auto;">
            <tr>
              <td style="background:#4a90e2; padding:8px 20px; border-radius:20px;">
                <a href="tel:+19047438444" style="color:#ffffff; text-decoration:none; font-size:16px; font-weight:bold;">
                  904-743-8444
                </a>
              </td>
            </tr>
          </table>
          
          <table width="100%" cellpadding="15" cellspacing="0" border="0">
            <tr><td style="border-top:1px solid #4a6078; font-size:1px; line-height:1px;">&nbsp;</td></tr>
          </table>
          
          <p style="font-size:13px; color:#95a5a6; margin:0; line-height:1.4;">
            Atlantic Security<br>
            1714 Cesery Blvd, Jacksonville, FL 32211
          </p>
        </td>
      </tr>
    </table>
  </body>
</html>`;
        }

        // Copy HTML to clipboard
        function copyToClipboard() {
            if (!validateForm()) return;
            
            const html = generateEmailHTML();
            navigator.clipboard.writeText(html).then(() => {
                const successMsg = document.getElementById('successMessage');
                successMsg.classList.add('show');
                setTimeout(() => {
                    successMsg.classList.remove('show');
                }, 10000);
            }).catch(err => {
                alert('Failed to copy to clipboard. Please try again.');
            });
        }

        // Send email via Outlook
        function sendEmail() {
            if (!validateForm()) return;
            
            const customerName = document.getElementById('customerName').value;
            const customerId = document.getElementById('customerId').value || generateCustomerId();
            const quoteId = document.getElementById('quoteId').value;
            const discountPercent = document.getElementById('discountPercent').value;
            
            const subject = `Special Offer for ${customerName} - Save ${discountPercent}% on Quote ${quoteId}`;
            
            // Copy HTML first
            copyToClipboard();
            
            // Create mailto link for Outlook
            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent('Please switch to HTML view to see the formatted email. The HTML code has been copied to your clipboard - paste it into a new HTML email in Outlook.')}`;
            
            // Open mailto
            window.location.href = mailtoLink;
        }

        // Download HTML file
        function downloadHTML() {
            if (!validateForm()) return;
            
            const customerName = document.getElementById('customerName').value;
            const customerId = document.getElementById('customerId').value || generateCustomerId();
            const quoteId = document.getElementById('quoteId').value;
            const discountPercent = document.getElementById('discountPercent').value;
            
            const html = generateEmailHTML();
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `atlantic-security-email-${customerName.replace(/\s+/g, '-').toLowerCase()}-${quoteId}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show success message
            const successMsg = document.getElementById('successMessage');
            successMsg.innerHTML = `
                <div style="display: flex; align-items: flex-start; gap: 15px;">
                    <div>
                        <strong style="font-size: 18px;">Success! HTML file downloaded!</strong>
                        <br><br>
                        <strong style="color: #2c5aa0;">File saved as:</strong> atlantic-security-email-${customerName.replace(/\s+/g, '-').toLowerCase()}-${quoteId}.html
                        <br><br>
                        <strong style="color: #2c5aa0;">Next Steps:</strong>
                        <ol style="margin: 15px 0 0 25px; line-height: 1.8; font-size: 15px;">
                            <li>Open the downloaded HTML file in your browser</li>
                            <li>Copy the entire page content (Ctrl+A, Ctrl+C)</li>
                            <li>Open your email client and create a new message</li>
                            <li>Switch to HTML view and paste the content</li>
                            <li>Add recipient email and send!</li>
                        </ol>
                    </div>
                </div>
            `;
            successMsg.classList.add('show');
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 15000);
        }

        // Form validation
        function validateForm() {
            const required = ['customerName', 'customerId', 'quoteId', 'originalPrice', 'discountPercent'];
            let isValid = true;
            
            required.forEach(field => {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    element.style.borderColor = '#dc3545';
                    element.style.boxShadow = '0 0 0 4px rgba(220, 53, 69, 0.1)';
                    isValid = false;
                } else {
                    element.style.borderColor = 'rgba(225, 229, 233, 0.8)';
                    element.style.boxShadow = 'none';
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields (marked with *)');
            }
            
            return isValid;
        }

        // Add event listeners for real-time preview and scroll
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['customerName', 'customerId', 'quoteId', 'originalPrice', 'discountPercent'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', updatePreview);
            });
            
            // Add scroll event listener for background transition
            window.addEventListener('scroll', updateBackground);
            
            // Initialize background
            updateBackground();
        });
    </script>
</body>
</html>